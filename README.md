# üõ´ Ryanair Interconnecting Flights API

A Spring Boot RESTful service that provides available **direct and interconnected flights** (with at most one stop) between two airports, using Ryanair‚Äôs Routes and Schedules APIs. The API filters results based on a specified departure and arrival datetime window.

---

## ‚ú® Features

* **Direct Flights**: DUB ‚Üí STN
* **Interconnected Flights**: DUB ‚Üí STN ‚Üí WRO (max 1 stop, with ‚â• 2h stopover)
* **Datetime Filtering**: Flights must depart at the same time or after `departureDateTime` and arrive at or before `arrivalDateTime`
* **Data Sources**: Generated via OpenAPI to simplofy model generation and interface definition

  * `Routes API`: Filtered to use **RYANAIR-operated**, non-connecting flights only
  * `Schedules API`: Monthly schedules by route
* **Performance**: Usage of Cache and CompletableFuture to parallelize calls and improve performance of the API.
* **Exception handling**: Meaningful responses and logging in case an external API is unavailable or any other error happens (like 400).

---

## üß≠ Project Structure

* `client` Feign/OpenAPI clients for external Ryanair APIs
* `config` Configuration of the different Spring properties, like the Async Executor.
* `controller` Exposes `/v1/interconnections` REST endpoint
* `dto` Domain-specific data transfer objects used (only FlightSlot for the time being)
* `exception` Custom exception hierarchy and error handling logic, including external API failure wrappers
* `mapping` Model converters between API and domain formats
* `service` Business logic: schedules, filtering, connection building. It includes the interfaces and the implementations
* `resources/openapi`OpenAPI specs for internal server and external clients
* `validation` Composable route and connection validators

---

## üîß Build Instructions

```bash
./mvnw clean package
```

The executable JAR will be located at:

```
target/flight-interconnector-soa-api-0.0.1-SNAPSHOT.jar
```

---

## ‚ñ∂Ô∏è Running the Application

*A requirement to run the application is to have Java 21 in the JAVA_HOME variable*

Run with Maven:

```bash
./mvnw spring-boot:run
```

Or directly with Java once the jar is built:

```bash
java -jar target/flight-interconnector-soa-api-0.0.1-SNAPSHOT.jar
```

### Example Request

```
GET /v1/interconnections?departure=DUB&arrival=STN&departureDateTime=2024-01-01T09:00&arrivalDateTime=2024-01-01T22:00
```

---

## ‚úÖ Testing

This project uses multiple test strategies

* **Unit Tests**
  Run with:

  ```bash
  ./mvnw test
  ```

* **Full Verification (Integration Tests + SpotBugs + Coverage)**
  Includes:

  * Spring Boot integration tests with WireMock-based mocks for external APIs
  * Static analysis with SpotBugs
  * Code coverage reports with JaCoCo

  Run with:

  ```bash
  ./mvnw verify
  ```
---

## ‚öôÔ∏è Configuration

Tunable async executor settings for external API calls:

```properties
external.api.executor.core-pool-size=10
external.api.executor.max-pool-size=30
external.api.executor.queue-capacity=100
```

To control the minimum required layover time between flights for the associated validator
```properties
interconnector.min-layover=PT2H               # ISO-8601 duration format (e.g. PT2H = 2 hours)
```

Also the Routes+Schedules API base url or timeout can be further configured there.

---
## üí° Potential Extensions

Though it has not been requested in the task, here there are some potential add-ons to the API.

* **Custom Filtering Logic**: Allow more dynamic route and connection validation, like country specific limitations or other ideas (if they make sense functionally).
* **Separation of Flight Strategies**: Split direct vs. one-stop logic into distinct components if the logic grows more complex.
* **Improved Caching Mechanism**: Replace simple `@Cacheable` with a smarter, controllable caching layer (e.g. configurable TTLs, eviction strategies, test-friendly APIs).
* **Optimality**: Filter out connections that are valid but clearly suboptimal (e.g. extremely long layovers or unnecessary detours).
* **Client-Side Filtering Support**: Expose additional query parameters to allow consumers to filter results (e.g. max stops, latest arrival time, max total duration).

---

ü§ñ AI-Assisted Development

There is nothing to hide. AI assistants are here to help and it is for me something I use in my daily life, tools I learn with and also that have to be taken with care (as they provide hallucinations sometimes)

For this project the AIs I have used are:

GitHub Copilot ‚Äì sped up routine coding by autocompleting as any IDE autocomplete tool.

ChatGPT ‚Äì consulted mainly for precise specific Spring-Boot configuration questions or pom setup issues (coming from a Quarkus background there are some small differences here and there) and for polishing this README and code comments. 

No logic nor architectural/design choices were generated by AI.